<- [back to index](../Readme.md)

## Aggregates, Entities and Value Objects

### Tenant
| Attributes | Type | Description |
| --- | --- | --- |
| id | Identity (UUID v4 [Link](https://en.wikipedia.org/wiki/Universally_unique_identifier)) | Generated by UI |
| permissions | Array < Permissions > |  |
| legalIdentification | LegalIdentification VO | Legal Identification Code of the country where the corporation exists. |
| region | Region VO | Quadrant internal geographical region identifier where data is located. |
| country | Country VO | Country where the corporation is based. |
| name | Name VO |  |
| status | Status VO | |

#### Value Objects:

#### LegalIdentification
| Attributes  | Type | Description |
| ----- | ----- | ----- |
| type | <String> | CIF, NIF, or equivalent for each Country |
| value | <String> | Example: J12066700 |

**Data processing**
- Data is converted to uppercase.

**Validation Rules**
- type/value: 
    - Validation using official algorithms. (pending)
- type: 
    - Allowed values: NIF,CIF. => tenantLegalIdentificationType.invalidValue

#### Name
| Attributes  | Type | Description |
| ----- | ----- | ----- |
| value | <String> |  |

**Data processing**
- None

**Validation Rules**
- name: 
    - Must be string. => tenantName.invalidType
    - Maximum 32 characters. => tenantName.invalidLength

#### Region
| Attributes  | Type | Description |
| ----- | ----- | ----- |
| value | <String> | Quadrant internal value that indicates where data will be stored |

**Data processing**
- None

**Validation Rules**
- value: 
    - Must be string. => tenantRegion.invalidType
    - Maximum 2 characters. => tenantRegion.invalidLength

#### Status
| Attributes  | Type | Description |
| ----- | ----- | ----- |
| value | <String> |  |

**Values**
- Active: All operations work as expected.
- Disabled: All operations altering the entity state are forbidden.

**Data processing**
- None

**Validation Rules**
- value: 
    - Allowed values: active,disabled. => tenantStatus.invalidValue

#### Country
See [generic Country](#Country)

#### Permissions
See [generic Permissions](#permission)


---


### Branch
| Attributes | Type | Description |
| --- | --- | --- |
| id | Identity (UUID v4 [Link](https://en.wikipedia.org/wiki/Universally_unique_identifier)) | Generated by UI |
| tenantId | Identity (UUID v4 [Link](https://en.wikipedia.org/wiki/Universally_unique_identifier)) | Relation to Tenant:Id |
| permissions | Array < Permissions > |  |
| name | Name VO |  |
| private | bool | Allows other branches of the same Tenant to search/access its data |
| status | Status VO |  |

#### Value Objects:

#### Name
| Attributes  | Type | Description |
| ----- | ----- | ----- |
| value | <String> |  |

**Data processing**
- None

**Validation Rules**
- name: 
    - Must be string. => branchName.invalidType
    - Maximum 32 characters. => branchName.invalidLength

#### Status
| Attributes  | Type | Description |
| ----- | ----- | ----- |
| value | <String> |  |

**Values**
- Active: All operations work as expected.
- Disabled: All operations altering the entity state are forbidden.

**Data processing**
- None

**Validation Rules**
- value: 
    - Allowed values: active,disabled => branchName.invalidValue

#### Permissions
See [generic Permissions](#permission)

---

### User
| Attributes | Type | Description |
| --- | --- | --- |
| id | Identity (UUID v4 [Link](https://en.wikipedia.org/wiki/Universally_unique_identifier)) | Generated by UI |
| tenantId | Identity (UUID v4 [Link](https://en.wikipedia.org/wiki/Universally_unique_identifier)) | Relation to Tenant:Id |
| branchId | Identity (UUID v4 [Link](https://en.wikipedia.org/wiki/Universally_unique_identifier)) | Relation to Branch:Id |
| permissions | Array < Permissions > |  |
| email | Email VO | Used for login |
| name | Name VO |  |
| status | Status VO | Current entity status  <br>\- active  <br>\- disabled |

#### Permissions
See [generic Permissions](#permission)

#### Email
 See [generic Email](#email)
#### Name
See [generic PersonName](#personName)

#### Status
| Attributes  | Type | Description |
| ----- | ----- | ----- |
| value | <String> |  |

**Values**
- Active: All operations work as expected.
- Disabled: All operations altering the entity state are forbidden.

**Data processing**
- None

**Validation Rules**
- value: 
    - Allowed values: active,disabled => branchName.invalidValue


## Generic/Shared Value Objects

### Country
[ISO 3166](https://en.wikipedia.org/wiki/List_of_ISO_3166_country_codes)
[https://www.iban.com/country-codes](https://www.iban.com/country-codes)

| Attributes  | Type | Description |
| ----- | ----- | ----- |
| iso31661Alpha2Code | <String> | ISO 3166 Alpha Code-2 or ISO-3166-2 [Link](https://en.wikipedia.org/wiki/ISO_3166-2) |
| iso31661Alpha3Code | <String> | ISO 3166 Alpha Code-3 or ISO-3166-3 [Link](https://en.wikipedia.org/wiki/ISO_3166-3) |
| englishName | <String> | English Name [Link](https://en.wikipedia.org/wiki/List_of_ISO_3166_country_codes) |


### Permission
| Attributes  | Type | Description |
| ----- | ----- | ----- |
| value | <String> |Ex: Can<Verb><Subject> |

- It could be stored in a look-up table as static variable.
- Terminology to be used when creating Permissions:
    - __Access__: Allow access and viewing and Viewing Resources as Wholesaver, Provider, Retailer sections or specific pages. Specific actions in that area should be defined individually.
    -  __Operate__: Comprises View/Create/Edit/Delete actions. 
        -  Ideally if this permission is added for an area, other more specific permissions should be removed.
        -  Only CanManage<SomeStuff> can add/revoke permissions.
    -  __Edit__: Edit Action.
    -  __Create__: Create Action.
    -  __Delete__: Delete Action.

- If needed, subject should be added from higher to lower order. Ex: TenantBranchUser.
- List of basic platform administrative permissions:

| Name | Description | Typically used by |
| ----- | ----- | ----- |
| CanManageAll | View/Create/Edit/Delete Tenants, branches and its data: Users, Clients, Trips, etc | Quadrant Admin only |
| CanEditTenant | Edit data from own Tenant | A responsible to modify important Tenant Data |
| CanManageBranches | Create/Edit/Delete Branches in own Tenant. | A responsible to modify important Tenant Data  |
| CanEditBranch | Edit own Branch data. | A responsible to modify important Branch Data |
| CanManageUsers | Create/Edit/Delete Users in own Branch | A responsible to modify important Branch Data |
| CanEditUser | Edit own User data | Any User |
| CanAccessWholesaver ?? | Can access to Wholesaver platform | Any User |
| CanAccessRetailer ?? | Can access to Retailers platform | Any User |

- _To be completed with future domain permissions_

### PersonName

| Attributes  | Type | Description |
| ----- | ----- | ----- |
| firstName | <String> |  |
| middleName | <String> \| Optional | Typical in English speaking countries. |
| lastName | <String> | |
| lastName2 | <String> \| Optional | In Spain and other Spanish speaking countries, as well as in Portugal |

**Data processing**
- None

**Validation Rules**
- value: 
    - Valid Characters: Regex LatinUnicode (/^([a-zA-ZÀ-ÖÙ-öù-ÿĀ-žḀ-ỿ\s\-\']+)$/)  => personName<AttributeName>.invalidValue
    - Maxímum length: 32 characters per attribute => personName<AttributeName>.maxLength

### Email

| Attributes  | Type | Description |
| ----- | ----- | ----- |
| value | <String> | Email address |

**Data processing**
- None

**Validation Rules**
- value: 
    - Valid Email format (filter_var/FILTER_VALIDATE_EMAIL https://php.net/manual/en/filter.constants.php ) => email.invalidFormat

---
