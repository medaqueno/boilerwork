# This docker-compose.yml file shows how Supervisor program(s) are reloaded automatically when file changes detected
# under web root /var/www. There are two environment variables used:
#     1. AUTORELOAD_PROGRAMS: space-separated Supervisor program(s) to be reloaded when file changes detected. e.g.,
#            AUTORELOAD_PROGRAMS: "swoole"       # Autoreload Supervisor program "swoole" only.
#            AUTORELOAD_PROGRAMS: "swoole nginx" # Autoreload Supervisor program "swoole" and "nginx".
#     2. AUTORELOAD_ANY_FILES: Optional. If set to "true", "1", "yes", or "y", reload Supervisor program(s) when any
#        files under the root directory (/var/www in this example) is changed; otherwise, reload only when PHP file(s)
#        are changed.
#
version: "3"

services:
  swoole-basic:
    container_name: swoole-basic
    build: .
    ports:
      - 3102:9501
    environment:
      AUTORELOAD_PROGRAMS: "swoole"
      AUTORELOAD_ANY_FILES: 0
    volumes:
      - ./src:/var/www
    networks:
      public:
  # redis-local:
  #   container_name: redis-local
  #   image: redis:5.0.6-alpine3.10
  #   restart: always
  #   ports:
  #     - 6380:6379
  #   networks:
  #     public:
  # environment:
  # - ALLOW_EMPTY_PASSWORD=yes
  # - SYSLOG-ENABLED=yes
  # command: redis-server --save 20 1 --loglevel warning
  # command: redis-server /usr/local/etc/redis/redis.conf --loglevel warning
  # volumes:
  #   - ./tmp/redis/data:/data
  #   - ./tmp/redis/log:/var/log/redis
  #   - ./rootfilesystem/redis/config/redis.conf:/usr/local/etc/redis/redis.conf

networks:
  public:
    name: pangea-net
