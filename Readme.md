# Bounded Context: Clients

  * [Index (This document)](#)
  * [First Run](./docs/FirstRun.md)
  * [Aggregates/Entities](./docs/AggregatesEntitiesVOs.md)
  * [Actions and Background Processes](./docs/ActionsProcesses.md)
  * [Projections/Views](./docs/ProjectionsViews.md)
  * [Test Coverage](./docs/TestCoverage.md)
  * [Permissions](./docs/Permissions.md)
  

## Purpose

Managing lifecyle of the different types of entities and aggregates related to users and business, and their capacity to perform actions.

Achieving the main objective: simplicity, allowing horizontal growth of permissions and avoiding any kind of hierarchy, dependency or complex *sql-join-like* relationships between permissions that lead to wiping out any ease of maintenance and understanding. **Composition over inheritance** is always preferable in the backend side.

## Objectives

The domain will meet these minimum requirements:

*   Create and manage Tenants.
*   Add Branches to Tenants, and manage their data.
*   Add Users to Branches, and manage their data.
*   Grant and revoke permissions to former entities in order to allow them perform actions in the system.
    
## Terminology

**Tenant**
- It is a Business or Organization.
- It is uniquely identified by a country legal code (CIF, NIF, etc.)
- It is the *billable* entity.
- A tenant comprises `Branches`.

**Branch**
- It is an arbitrary tenant division. This division can be administative, geographical, etc.
- Must exist a minimum of one Branch per `Tenant`.
- A Branch comprises `Users`.
- Branch data may be hidden to other branches (Excepting to __Main branch__)

**User**
- Anyone who has credentials and is able to log in the platform.
- A user can interact and perform actions in the platform.
- A user may have many `Permissions`.

**Profile**
- Profiles are only _cosmetic tags_ to make easier to UX describe user position.
- It must not have any impact on actions allowance (`Permissions` are used for it).
- Permissions and Profiles are __completely dissociated__.
- May be served from a plain json or even "hardcoded" in frontend. Backend will not use them to control access to resources or endpoints.

> __Profiles may not finally exist, depends on UX decision.__

**Permission**
- It allows a given `User` to access specific resources or perform an action.
- They are cumulative and can be granted to `Users` individually.
- The platform must forbid actions by default.
- Permissions always allow, they never forbid or exclude an action.
- Permissions are checked both in frontend and backend as an authorization control.
- It is recommended to use `Permissions` the most globally possible in order to be simple to use and not create a [big ball of snow impossible to maintain](https://media.giphy.com/media/kiBq3jR2ixgAxATx5h/giphy.gif). It will be always a better choice to create a permission that allows to access a section in frontend than create many individual permissions for the actions inside that section. ==Use them wisely==.
- The name must be expressive and self descripting.
-- Recommended Format: Can<Verb><Subject> : CanViewHotelsVertical, CanEditTenant, CanCreateTravel, CanCreateHotelBooking, etc.

## Conventions

**Identities**

All resources identities will be primarily generated by client and sent to the backend with the rest of data.

Format accepted is Universally Unique IDentifier UUID v4.
[Link](https://en.wikipedia.org/wiki/Universally_unique_identifier)

**Date, DateTime and TimeZones**

All input/output DateTime format will be ==ATOM or ISO-8601 extended== version.

```
2021-01-03T02:30:00+00:00
```

> The problem with the ISO8601 basic format is in the fact that the time zone designator part of the date/time string does not have a colon separating the hours and minutes. To understand why this is an issue, you must understand that ISO-8601 allows two formatting options for date and time and expects the entire string (i.e. the date, time, and time zone parts) to follow the same format.

Date format (YYYY-MM-DD):
```
2021-01-03
```

**Countries**

All input/output Country format will be ==ISO 3166-1 Alpha2== version.

Link: https://www.iso.org/standard/72483.html

However, a Generic Country Value Object exist and can be created using ISO 3166-1 Alpha2 and ISO 3166-1 Alpha3. 
Once created this VO holds both codes plus the corresponding English name of the Country
